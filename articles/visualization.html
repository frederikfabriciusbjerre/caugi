<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualizing Causal Graphs with caugi • caugi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing Causal Graphs with caugi">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">caugi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/get_started.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/motivation.html">Motivation</a></li>
    <li><a class="dropdown-item" href="../articles/package_use.html">How to use caugi in a package</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualizing Causal Graphs with caugi</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/frederikfabriciusbjerre/caugi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Visualizing Causal Graphs with caugi</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/frederikfabriciusbjerre/caugi/blob/main/vignettes/visualization.Rmd" class="external-link"><code>vignettes/visualization.Rmd</code></a></small>
      <div class="d-none name"><code>visualization.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://caugi.org/">caugi</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>caugi</code> package provides a flexible plotting system
built on grid graphics for visualizing causal graphs. This vignette
demonstrates how to create plots with different layout algorithms and
customize their appearance.</p>
<div class="section level2">
<h2 id="basic-plotting">Basic Plotting<a class="anchor" aria-label="anchor" href="#basic-plotting"></a>
</h2>
<p>The simplest way to visualize a <code>caugi</code> graph is with the
<code><a href="../reference/plot.html">plot()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a simple DAG</span></span>
<span><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi.html">caugi</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span>,</span>
<span>  <span class="va">B</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">D</span>,</span>
<span>  <span class="va">C</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">D</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"DAG"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot with default settings</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/basic-plot-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p>By default, <code><a href="../reference/plot.html">plot()</a></code> automatically selects the best layout
algorithm based on your graph type. For graphs with only directed edges,
it uses the Sugiyama hierarchical layout. For graphs with other edge
types, it uses the Fruchterman-Reingold force-directed layout.</p>
</div>
<div class="section level2">
<h2 id="layout-algorithms">Layout Algorithms<a class="anchor" aria-label="anchor" href="#layout-algorithms"></a>
</h2>
<p>The <code>caugi</code> package provides three layout algorithms, each
optimized for different use cases.</p>
<div class="section level3">
<h3 id="sugiyama-hierarchical-layout">Sugiyama (Hierarchical Layout)<a class="anchor" aria-label="anchor" href="#sugiyama-hierarchical-layout"></a>
</h3>
<p>The Sugiyama layout <span class="citation">(Sugiyama, Tagawa, and
Toda 1981)</span> is ideal for directed acyclic graphs (DAGs). It
arranges nodes in layers to emphasize hierarchical structure and causal
flow from top to bottom, minimizing edge crossings.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a more complex DAG</span></span>
<span><span class="va">dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi.html">caugi</a></span><span class="op">(</span></span>
<span>  <span class="va">X1</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">M1</span> <span class="op">+</span> <span class="va">M2</span>,</span>
<span>  <span class="va">X2</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">M2</span> <span class="op">+</span> <span class="va">M3</span>,</span>
<span>  <span class="va">M1</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">Y</span>,</span>
<span>  <span class="va">M2</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">Y</span>,</span>
<span>  <span class="va">M3</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">Y</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"DAG"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use Sugiyama layout explicitly</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">dag</span>, layout <span class="op">=</span> <span class="st">"sugiyama"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/sugiyama-layout-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p><strong>Best for:</strong> DAGs, causal models, hierarchical
structures</p>
<p><strong>Limitations:</strong> Only works with directed edges</p>
</div>
<div class="section level3">
<h3 id="fruchterman-reingold-spring-electrical">Fruchterman-Reingold (Spring-Electrical)<a class="anchor" aria-label="anchor" href="#fruchterman-reingold-spring-electrical"></a>
</h3>
<p>The Fruchterman-Reingold layout <span class="citation">(Fruchterman
and Reingold 1991)</span> uses a physical simulation where edges act as
springs and nodes repel each other like charged particles. It produces
organic, symmetric layouts with relatively uniform edge lengths.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a graph with bidirected edges (ADMG)</span></span>
<span><span class="va">admg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi.html">caugi</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">C</span>,</span>
<span>  <span class="va">B</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">C</span>,</span>
<span>  <span class="va">A</span> <span class="op"><a href="../reference/edge_operators.html">%&lt;-&gt;%</a></span> <span class="va">B</span>, <span class="co"># Bidirected edge (latent confounder)</span></span>
<span>  class <span class="op">=</span> <span class="st">"ADMG"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fruchterman-Reingold handles all edge types</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">admg</span>, layout <span class="op">=</span> <span class="st">"fruchterman-reingold"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/fruchterman-reingold-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p><strong>Best for:</strong> General-purpose visualization, graphs with
mixed edge types</p>
<p><strong>Advantages:</strong> Fast, works with all edge types,
produces balanced layouts</p>
</div>
<div class="section level3">
<h3 id="kamada-kawai-stress-minimization">Kamada-Kawai (Stress Minimization)<a class="anchor" aria-label="anchor" href="#kamada-kawai-stress-minimization"></a>
</h3>
<p>The Kamada-Kawai layout <span class="citation">(Kamada and Kawai
1989)</span> minimizes “stress” by making Euclidean distances in the
plot proportional to graph-theoretic distances. This produces
high-quality layouts that better preserve the global structure compared
to Fruchterman-Reingold.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an undirected graph</span></span>
<span><span class="va">ug</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi.html">caugi</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">B</span>,</span>
<span>  <span class="va">B</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">C</span> <span class="op">+</span> <span class="va">D</span>,</span>
<span>  <span class="va">C</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">D</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"UG"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Kamada-Kawai for publication-quality visualization</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ug</span>, layout <span class="op">=</span> <span class="st">"kamada-kawai"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/kamada-kawai-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p><strong>Best for:</strong> Publication-quality figures, when accurate
distance representation matters</p>
<p><strong>Advantages:</strong> Better global structure preservation</p>
</div>
<div class="section level3">
<h3 id="comparing-layouts">Comparing Layouts<a class="anchor" aria-label="anchor" href="#comparing-layouts"></a>
</h3>
<p>You can compute and examine layout coordinates directly using
<code><a href="../reference/caugi_layout.html">caugi_layout()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute layouts</span></span>
<span><span class="va">layout_sug</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi_layout.html">caugi_layout</a></span><span class="op">(</span><span class="va">dag</span>, method <span class="op">=</span> <span class="st">"sugiyama"</span><span class="op">)</span></span>
<span><span class="va">layout_fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi_layout.html">caugi_layout</a></span><span class="op">(</span><span class="va">dag</span>, method <span class="op">=</span> <span class="st">"fruchterman-reingold"</span><span class="op">)</span></span>
<span><span class="va">layout_kk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi_layout.html">caugi_layout</a></span><span class="op">(</span><span class="va">dag</span>, method <span class="op">=</span> <span class="st">"kamada-kawai"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">layout_sug</span><span class="op">)</span></span>
<span><span class="co">#&gt;   name    x   y</span></span>
<span><span class="co">#&gt; 1   X1 0.25 0.0</span></span>
<span><span class="co">#&gt; 2   X2 0.75 0.0</span></span>
<span><span class="co">#&gt; 3   M1 0.00 0.5</span></span>
<span><span class="co">#&gt; 4   M2 0.50 0.5</span></span>
<span><span class="co">#&gt; 5   M3 1.00 0.5</span></span>
<span><span class="co">#&gt; 6    Y 0.50 1.0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="customizing-plots">Customizing Plots<a class="anchor" aria-label="anchor" href="#customizing-plots"></a>
</h2>
<p>The <code><a href="../reference/plot.html">plot()</a></code> function provides extensive customization
options for nodes, edges, and labels.</p>
<div class="section level3">
<h3 id="node-styling">Node Styling<a class="anchor" aria-label="anchor" href="#node-styling"></a>
</h3>
<p>Customize node appearance with the <code>node_style</code>
parameter:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customize node colors and sizes</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">cg</span>,</span>
<span>  node_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"lightblue"</span>, <span class="co"># Fill color</span></span>
<span>    col <span class="op">=</span> <span class="st">"darkblue"</span>, <span class="co"># Border color</span></span>
<span>    lwd <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Border width</span></span>
<span>    padding <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Text padding (mm)</span></span>
<span>    size <span class="op">=</span> <span class="fl">1.2</span> <span class="co"># Size multiplier</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/node-styling-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p>Available node style parameters:</p>
<ul>
<li>
<strong>Appearance (passed to <code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar()</a></code>)</strong>:
<code>fill</code>, <code>col</code>, <code>lwd</code>, <code>lty</code>,
<code>alpha</code>
</li>
<li>
<strong>Geometry</strong>: <code>padding</code> (text padding in
mm), <code>size</code> (node size multiplier)</li>
</ul>
</div>
<div class="section level3">
<h3 id="edge-styling">Edge Styling<a class="anchor" aria-label="anchor" href="#edge-styling"></a>
</h3>
<p>Customize edge appearance with the <code>edge_style</code> parameter.
You can set global options or customize each edge type separately:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Global edge styling</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">dag</span>,</span>
<span>  edge_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">"darkgray"</span>, <span class="co"># Edge color</span></span>
<span>    lwd <span class="op">=</span> <span class="fl">1.5</span>, <span class="co"># Edge width</span></span>
<span>    arrow_size <span class="op">=</span> <span class="fl">4</span> <span class="co"># Arrow size (mm)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/edge-styling-global-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Per-type edge styling for ADMG</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">admg</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"fruchterman-reingold"</span>,</span>
<span>  edge_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    directed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    bidirected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/edge-styling-per-type-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p>Available edge style parameters:</p>
<ul>
<li>
<strong>Appearance (passed to <code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar()</a></code>)</strong>:
<code>col</code>, <code>lwd</code>, <code>lty</code>,
<code>alpha</code>, <code>fill</code>
</li>
<li>
<strong>Geometry</strong>: <code>arrow_size</code> (arrow length in
mm)</li>
<li>
<strong>Per-type options</strong>: <code>directed</code>,
<code>undirected</code>, <code>bidirected</code>,
<code>partial</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="label-styling">Label Styling<a class="anchor" aria-label="anchor" href="#label-styling"></a>
</h3>
<p>Customize node labels with the <code>label_style</code>
parameter:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customize label appearance</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">cg</span>,</span>
<span>  label_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">"white"</span>, <span class="co"># Text color</span></span>
<span>    fontsize <span class="op">=</span> <span class="fl">12</span>, <span class="co"># Font size</span></span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, <span class="co"># Font face</span></span>
<span>    fontfamily <span class="op">=</span> <span class="st">"sans"</span> <span class="co"># Font family</span></span>
<span>  <span class="op">)</span>,</span>
<span>  node_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"navy"</span> <span class="co"># Dark background for white text</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/label-styling-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p>Available label style parameters (passed to <code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar()</a></code>):</p>
<ul>
<li>
<code>col</code>, <code>fontsize</code>, <code>fontface</code>,
<code>fontfamily</code>, <code>cex</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="combining-customizations">Combining Customizations<a class="anchor" aria-label="anchor" href="#combining-customizations"></a>
</h3>
<p>Put it all together for a fully customized plot:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a publication-ready plot</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">dag</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"sugiyama"</span>,</span>
<span>  node_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"#E8F4F8"</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"#2C5F77"</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    padding <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  edge_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">"#555555"</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>    arrow_size <span class="op">=</span> <span class="fl">3.5</span></span>
<span>  <span class="op">)</span>,</span>
<span>  label_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">"#1A1A1A"</span>,</span>
<span>    fontsize <span class="op">=</span> <span class="fl">11</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/full-customization-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="working-with-different-graph-types">Working with Different Graph Types<a class="anchor" aria-label="anchor" href="#working-with-different-graph-types"></a>
</h2>
<p>The plotting system works seamlessly with all supported graph
types.</p>
<div class="section level3">
<h3 id="partially-directed-acyclic-graphs-pdags">Partially Directed Acyclic Graphs (PDAGs)<a class="anchor" aria-label="anchor" href="#partially-directed-acyclic-graphs-pdags"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a PDAG with both directed and undirected edges</span></span>
<span><span class="va">pdag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi.html">caugi</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">B</span>,</span>
<span>  <span class="va">B</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">C</span>, <span class="co"># Undirected edge</span></span>
<span>  <span class="va">C</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">D</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"PDAG"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">pdag</span>,</span>
<span>  edge_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    directed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>    undirected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/pdag-plot-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="acyclic-directed-mixed-graphs-admgs">Acyclic Directed Mixed Graphs (ADMGs)<a class="anchor" aria-label="anchor" href="#acyclic-directed-mixed-graphs-admgs"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an ADMG with confounding</span></span>
<span><span class="va">complex_admg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi.html">caugi</a></span><span class="op">(</span></span>
<span>  <span class="va">X</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">M1</span> <span class="op">+</span> <span class="va">M2</span>,</span>
<span>  <span class="va">M1</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">Y</span>,</span>
<span>  <span class="va">M2</span> <span class="op"><a href="../reference/edge_operators.html">%--&gt;%</a></span> <span class="va">Y</span>,</span>
<span>  <span class="va">M1</span> <span class="op"><a href="../reference/edge_operators.html">%&lt;-&gt;%</a></span> <span class="va">M2</span>, <span class="co"># Latent confounder between mediators</span></span>
<span>  class <span class="op">=</span> <span class="st">"ADMG"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">complex_admg</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"kamada-kawai"</span>,</span>
<span>  node_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lavender"</span><span class="op">)</span>,</span>
<span>  edge_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    directed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>    bidirected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, arrow_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/admg-plot-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="undirected-graphs-ugs">Undirected Graphs (UGs)<a class="anchor" aria-label="anchor" href="#undirected-graphs-ugs"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a Markov network</span></span>
<span><span class="va">markov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi.html">caugi</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span>,</span>
<span>  <span class="va">B</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">D</span>,</span>
<span>  <span class="va">C</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">D</span> <span class="op">+</span> <span class="va">E</span>,</span>
<span>  <span class="va">D</span> <span class="op"><a href="../reference/edge_operators.html">%---%</a></span> <span class="va">E</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"UG"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">markov</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"fruchterman-reingold"</span>,</span>
<span>  node_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"lightyellow"</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  edge_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/ug-plot-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-usage">Advanced Usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h2>
<div class="section level3">
<h3 id="manual-layouts">Manual Layouts<a class="anchor" aria-label="anchor" href="#manual-layouts"></a>
</h3>
<p>You can compute layouts separately and reuse them:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute layout once</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caugi_layout.html">caugi_layout</a></span><span class="op">(</span><span class="va">dag</span>, method <span class="op">=</span> <span class="st">"sugiyama"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The layout can be used for analysis or custom plotting</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span></span>
<span><span class="co">#&gt;   name    x   y</span></span>
<span><span class="co">#&gt; 1   X1 0.25 0.0</span></span>
<span><span class="co">#&gt; 2   X2 0.75 0.0</span></span>
<span><span class="co">#&gt; 3   M1 0.00 0.5</span></span>
<span><span class="co">#&gt; 4   M2 0.50 0.5</span></span>
<span><span class="co">#&gt; 5   M3 1.00 0.5</span></span>
<span><span class="co">#&gt; 6    Y 0.50 1.0</span></span>
<span></span>
<span><span class="co"># Plot uses the same layout, calling caugi_layout internally</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">dag</span>, layout <span class="op">=</span> <span class="st">"sugiyama"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/manual-layout-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="integration-with-grid-graphics">Integration with Grid Graphics<a class="anchor" aria-label="anchor" href="#integration-with-grid-graphics"></a>
</h3>
<p><code>caugi</code> plots are built on grid graphics, and provide
access to the underlying grid <code>grob</code> object in the
<code>@grob</code> slot of the plot output. This allows for further
customization using grid functions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The grob slot is a grid graphics object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">p</span><span class="op">@</span><span class="va">grob</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "gTree" "grob"  "gDesc"</span></span>
<span></span>
<span><span class="co"># You can manipulate it with grid functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw the plot rotated by 30 degrees</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html" class="external-link">grid.draw</a></span><span class="op">(</span><span class="va">p</span><span class="op">@</span><span class="va">grob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/grid-integration-1.png" class="r-plt" width="700" style="display: block; margin: auto;"></p>
<p>This also allows you to arrange multiple <code>caugi</code> plots
using packages like <a href="https://cran.r-project.org/package=gridExtra" class="external-link">gridExtra</a>.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-fruchterman1991" class="csl-entry">
Fruchterman, Thomas M. J., and Edward M. Reingold. 1991. <span>“Graph
Drawing by Force-Directed Placement.”</span> <em>Software: Practice and
Experience</em> 21 (11): 1129–64. <a href="https://doi.org/10.1002/spe.4380211102" class="external-link">https://doi.org/10.1002/spe.4380211102</a>.
</div>
<div id="ref-kamada1989" class="csl-entry">
Kamada, Tomihisa, and Satoru Kawai. 1989. <span>“An Algorithm for
Drawing General Undirected Graphs.”</span> <em>Information Processing
Letters</em> 31 (1): 7–15. <a href="https://doi.org/10.1016/0020-0190(89)90102-6" class="external-link">https://doi.org/10.1016/0020-0190(89)90102-6</a>.
</div>
<div id="ref-sugiyama1981" class="csl-entry">
Sugiyama, Kozo, Shojiro Tagawa, and Mitsuhiko Toda. 1981. <span>“Methods
for Visual Understanding of Hierarchical System Structures.”</span>
<em>IEEE Transactions on Systems, Man, and Cybernetics</em> 11 (2):
109–25. <a href="https://doi.org/10.1109/TSMC.1981.4308636" class="external-link">https://doi.org/10.1109/TSMC.1981.4308636</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Frederik Fabricius-Bjerre, Johan Larsson, Michael Sachs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
